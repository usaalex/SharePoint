/* SPRest 0.1.0 */
/* https://github.com/usaalex/SharePoint */
/* © WM-FDH, 2016 */
var SPRest = function (t) { "use strict"; function e(t) { u = t || null } function a(t) { return "SP.Data." + t.replace(/\s/g, "") + "ListItem" } function n() { return document.getElementById("__REQUESTDIGEST").value } function r(t, e, a) { return u({ url: "{0}/_api/web/lists/getbytitle('{1}')/items{2}".format(a || _spPageContextInfo.webServerRelativeUrl, t, e || ""), headers: { accept: "application/json; odata=nometadata" }, method: "GET" }).then(function (t) { return t || [] }) } function i(t, e, a, n) { return u({ url: "{0}/_api/web/lists/getbytitle('{1}')/items({2}){3}".format(n || _spPageContextInfo.webServerRelativeUrl, t, e, a || ""), headers: { accept: "application/json; odata=nometadata" }, method: "GET" }).then(function (t) { return t || null }) } function o(t, e, r, i, o) { return r.__metadata = { type: i || a(t) }, u({ url: "{0}/_api/web/lists/getbytitle('{1}')/items({2})".format(o || _spPageContextInfo.webServerRelativeUrl, t, e), type: "POST", data: JSON.stringify(r), headers: { accept: "application/json;odata=nometadata", "content-type": "application/json;odata=verbose", "X-RequestDigest": n(), "X-HTTP-Method": "MERGE", "If-Match": "*" } }).then(function (t) { return t || null }) } function s(t, e, a, r) { return u({ url: "{0}/_api/web/lists/getbytitle('{1}')/items({2}){3}".format(r || _spPageContextInfo.webServerRelativeUrl, t, e, a ? "" : "/recycle()"), type: a ? "DELETE" : "POST", headers: { accept: "application/json;odata=nometadata", "X-RequestDigest": n(), "If-Match": "*" } }) } function l(t, e, r, i) { return e.__metadata = { type: r || a(t) }, u({ url: "{0}/_api/web/lists/getbytitle('{1}')/items".format(i || _spPageContextInfo.webServerRelativeUrl, t), method: "POST", data: JSON.stringify(e), headers: { accept: "application/json;odata=nometadata", "content-type": "application/json;odata=verbose", "X-RequestDigest": n() } }).then(function (t) { return t || null }) } String.prototype.format = function () { for (var t = this, e = 0; e < arguments.length; e++) { var a = new RegExp("{" + e + "\\}", "g"); t = t.replace(a, arguments[e]) } return t }; var u = t || null; return { getListItems: r, getListItemById: i, createListItem: l, updateListItem: o, deleteListItem: s, setHttpProvider: e } }("undefined" != typeof jQuery ? jQuery.ajax : null);