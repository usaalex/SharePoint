/* SPRest 0.1.0 */
/* https://github.com/usaalex/SharePoint */
/* © WM-FDH, 2016 */
var SPRest = function (t) { "use strict"; function e(t) { u = t || null } function a(t) { return "SP.Data." + t.replace(/\s/g, "") + "ListItem" } function n() { return document.getElementById("__REQUESTDIGEST").value } function r(t, e, a) { return u({ url: "{0}/_api/web/lists/getbytitle('{1}')/items{2}".format(a || _spPageContextInfo.webServerRelativeUrl, t, e || ""), headers: { accept: "application/json;odata=nometadata" }, method: "GET" }) } function i(t, e, a) { var r = { query: { __metadata: { type: "SP.CamlQuery" }, ViewXml: e } }; return u({ url: "{0}/_api/web/lists/getbytitle('{1}')/getitems".format(a || _spPageContextInfo.webServerRelativeUrl, t), headers: { accept: "application/json;odata=nometadata", "content-type": "application/json;odata=nometadata", "X-RequestDigest": n() }, data: JSON.stringify(r), method: "POST" }) } function o(t, e, a, n) { return u({ url: "{0}/_api/web/lists/getbytitle('{1}')/items({2}){3}".format(n || _spPageContextInfo.webServerRelativeUrl, t, e, a || ""), headers: { accept: "application/json;odata=nometadata" }, method: "GET" }) } function s(t, e, r, i, o) { return r.__metadata = { type: i || a(t) }, u({ url: "{0}/_api/web/lists/getbytitle('{1}')/items({2})".format(o || _spPageContextInfo.webServerRelativeUrl, t, e), method: "POST", data: JSON.stringify(r), headers: { accept: "application/json;odata=verbose", "content-type": "application/json;odata=verbose", "X-RequestDigest": n(), "X-HTTP-Method": "MERGE", "If-Match": "*" } }) } function l(t, e, a, r) { return u({ url: "{0}/_api/web/lists/getbytitle('{1}')/items({2}){3}".format(r || _spPageContextInfo.webServerRelativeUrl, t, e, a ? "" : "/recycle()"), method: a ? "DELETE" : "POST", headers: { accept: "application/json;odata=nometadata", "X-RequestDigest": n(), "If-Match": "*" } }) } function p(t, e, r, i, o) { return e.__metadata = { type: r || a(t) }, u({ url: "{0}/_api/web/lists/getbytitle('{1}')/items{2}".format(o || _spPageContextInfo.webServerRelativeUrl, t, i || ""), method: "POST", data: JSON.stringify(e), headers: { accept: "application/json;odata=nometadata", "content-type": "application/json;odata=verbose", "X-RequestDigest": n() } }) } String.prototype.format = function () { for (var t = this, e = 0; e < arguments.length; e++) { var a = new RegExp("{" + e + "\\}", "g"); t = t.replace(a, arguments[e]) } return t }; var u = t || null; return { getListItems: r, getListItemById: o, createListItem: p, updateListItem: s, deleteListItem: l, getListItemsCAML: i, setHttpProvider: e } }("undefined" != typeof jQuery ? jQuery.ajax : null);